# TODO
## Critical Issues
1. Database Entity Misalignment
File: ClockStateEntity.kt, PurrTimeDatabase.kt
Current: No UUID type converter registered for Clock entities
Issue: The UUID field in ClockStateEntity requires a TypeConverter but only partial converter exists
Required Change: Ensure UUID converter is properly registered and working

## Consistency Issues
1. ViewModel Initialization Pattern
File: ClockOverlayService.kt, lines 358-398
Current: Uses custom initialize() method instead of constructor injection
Issue: Violates MVVM pattern from Technical Architecture Decisions
Required Change: Use ViewModelFactory with constructor parameters

2. Color Mapping Inconsistency
File: ClockView.kt, lines 198-225
Current: Hard-coded color values instead of using PurramidPalette
Issue: Duplicates color definitions, harder to maintain
Required Change: Import and use PurramidPalette constants

3. Button State Management
File: ClockOverlayService.kt, lines 470-507
Current: Manual tint application instead of using state list drawable
Issue: Doesn't follow Button Implementation Guide
Required Change: Use @color/button_tint_state_list consistently

## Missing Features
1. Nested Clock Stacking Logic
File: ClockOverlayService.kt, lines 856-900
Current: Basic implementation but specification requires "newest on bottom"
Issue: Stacking order incorrect per spec section (8.5.1)
Required Change: Reverse stacking order logic

2. Manual Time Setting Reset
File: ClockViewModel.kt
Current: Reset doesn't properly handle manually set time
Issue: Spec section (11.3.2) requires clearing time deficit
Required Change: Calculate and apply proper time correction

## Code Quality Issues
1. Error Handling
File: TimeZoneRepositoryImpl.kt
Current: Silent failures in CSV/GeoJSON parsing
Issue: No user feedback on data load failures
Required Change: Propagate errors to UI with Snackbar

2. Performance
File: ClockView.kt, lines 417-450
Current: Calculates angles on every touch move
Issue: Performance impact on low-end devices
Required Change: Throttle updates or cache calculations